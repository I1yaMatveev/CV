name: Deploy Jekyll to GitHub Pages

on:
    push:
        branches:
            - main # Запуск при пуше в main

jobs:
    build-deploy:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout репозиторий
              uses: actions/checkout@v4

            - name: Установка Ruby и Bundler
              uses: ruby/setup-ruby@v1
              with:
                  ruby-version: '3.2'
                  bundler-cache: true

            - name: Установка зависимостей
              run: bundle install

            - name: Сборка сайта Jekyll
              run: JEKYLL_ENV=production bundle exec jekyll build

            - name: Деплой в GitHub Pages
              uses: peaceiris/actions-gh-pages@v4
              with:
                  github_token: ${{ secrets.GITHUB_TOKEN }}
                  publish_dir: ./_site
